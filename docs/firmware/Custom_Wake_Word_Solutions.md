# 自定义唤醒词解决方案 (Custom Wake Word Solutions)

针对 "Hi, Trump!" 这一特定的自定义唤醒需求，我们在 ESP32-S3 平台上有以下四种实操方案。

---

## 1. 方案 1：乐鑫官方定制服务 (WakeNet)

这是性能天花板，适合对商业品质有极高要求的量产产品。

- **实现原理**：乐鑫利用其海量的私有声学数据集，结合你提供的关键词，进行深度神经网络训练。
- **合作要求**：
    - **语料需求**：通常需要数万条不同人的语音样本。
    - **定制成本**：包含一笔可观的 NRE (研发费) 及后期可能的授权费。
- **评价**：适合预算充足、出货量大（数万台级别）的企业。对于 100-500 台规模，性价比极低。

## 2. 方案 2：Picovoice Porcupine (推荐)

目前全球公认的端侧唤醒词 Top 方案，完美支持 ESP32-S3。

- **核心优势**：
    - **纯离线运行 (On-device)**：唤醒判定完全在 ESP32 芯片内完成，无需实时连接云端，保护用户隐私且响应极快。
    - **零门槛生成**：只需在网页控制台输入单词即可生成模型。
- **联网逻辑与设备计数**：
    - **硬件指纹绑定**：SDK 初始化时会读取 ESP32-S3 的唯一硬件 ID (Unique Chip ID)。Picovoice 服务器根据该 ID 计数，而不是根据烧录次数。
    - **重复烧录不计数**：同一块板子烧录 100 次，在后台依然只算作 **1 台** 活跃设备。
    - **授权校验**：仅在设备启动初次联网时进行 AccessKey 与硬件 ID 的配对校验。
- **成本构成**：
    - **个人/开发**：完全免费（通常限制每月活跃设备数 MAD，例如 3 台）。
    - **量产**：需联系官网购买商业 License。
- **实操流程**：
    1. **训练**：在 [Picovoice Console](https://console.picovoice.ai/) 输入 "Hi Trump"，环境选 ESP32，生成并下载 `.ppn` 模型。
    2. **集成**：将模型文件转换为 C 语言数组，配合 Porcupine lib 编译进固件。
    3. **授权**：使用你在官网申请的 `AccessKey`（免费版即可支持）进行初始化。

## 3. 方案 3：开源自训练 (Edge Impulse / microWakeWord)

如果你希望完全掌握代码主导权且不付任何授权费，这是最佳路径。

- **工具链**：[Edge Impulse](https://www.edgeimpulse.com/) (Web 端训练平台) + TensorFlow Lite for Microcontrollers。
- **实施流程**：
    1. **语料收集**：下载开源的语音数据集（如 Google Speech Commands），并自己录制约 50-100 段 "Hi Trump" 的变体。
    2. **模型训练**：在 Edge Impulse 平台一键训练。
    3. **部署**：导出为 C++ 代码块，集成进 ESP-IDF 工程。
- **评价**：适合具备一定 AI 背景的工程师，虽然过程费力，但长期成本为零。

---

## 4. 方案 4：外置专用语音唤醒芯片 (Hardware-based KWS DSP)

该方案通过增加一颗低成本、低功耗的专用语音处理芯片（如国芯 GX8002、Synaptics 或类似国产 ASIC）来实现离线唤醒。

### 4.1 核心优势
- **超低待机功耗**：专用芯片待机电流可低至 **uA 级别**。ESP32-S3 可进入深睡眠，仅在唤醒瞬间被外部中断点亮。
- **硬件级 AFE 加速**：部分芯片集成了硬件 AEC 和 Beamforming，拾音精度和远场性能优于 ESP32 软件处理。
- **无需永久授权费**：购买芯片即买断算法，无需向软件商支付按台计费的 Royalty。

### 4.2 挑战与局限
- **BOM 成本增量**：500 台量级下单价约为 **¥10 - ¥15**。
- **PCB 布局压力**：需要在狭窄的主板空间增加一颗主控级芯片及其配套的外围电路（晶振、退耦电容）。
- **同步延时**：存在“硬件唤醒 -> ESP32 启动 -> 网络握手”的时间差，若处理不好会导致用户第一句话的首个单词丢失。

---

## 5. 方案深度对比汇总

| 指标 | 方案 1 (官方) | 方案 2 (Picovoice) | 方案 3 (开源) | 方案 4 (外置芯片) |
| :--- | :--- | :--- | :--- | :--- |
| **实施速度** | 🐌 慢 | 🚀 极快 | � 较慢 | 🌕 中 |
| **BOM 成本** | 0 | 0 | 0 | **+ ¥12 左右** |
| **授权费** | 高 (NRE) | 约 $1/台 (规模化后) | 0 | 0 (含在芯片费中) |
| **续航表现** | 一般 (CPU 始终运行) | 一般 (CPU 始终运行) | 一般 (CPU 始终运行) | **极佳 (CPU 可休眠)** |
| **物理体积** | 零占用 | 零占用 | 零占用 | 占用约 10x10mm 面积 |

---

## 6. 本项目决策导向 (Decision Guidance)

针对 **500 台首批试产**：

1. **建议优先级 A：方案 1 (Picovoice)**。
   - **理由**：作为初创项目，**时间成本 > 零件成本**。Picovoice 可以在不改硬件、不改 PCBA 的前提下，一小时内完成各路名人（Trump/Musk）的唤醒词切换。
2. **建议优先级 B：方案 3 (外置芯片)**。
   - **理由**：若产品定位为“全天候待机潮玩”，且电池容量受限。可考虑在第二版 (V2) 硬件中加入国芯 GX8002。
3. **建议优先级 C：方案 2 (官方定制)**。
   - **理由**：除非单次下单超过 10k 台，否则昂贵的 NRE 费用会拖垮初创现金流。

---

## 6. 针对本项目的阶段决策方案 (Execution Strategy)

1.  **Demo/研发期 (1-5台)**：
    - **路径**：使用 Picovoice Free Plan。
    - **成本**：**$0**。
    - **目标**：验证产品经理对 "Hi Trump" 这一唤醒词的体验是否满意。

    - **目标**：快速交付给核心发烧友，验证市场反馈。

3.  **正式量产期 (>1000台)**：
    - **路径**：转向乐鑫 WakeNet 定制化服务。
    - **成本**：支付一次性 NRE 费用，换取无月费限制的长期稳定性。
    - **目标**：降低单机分摊成本，建立长期技术护城河。
- **语料库 (Corpus)**：训练 AI 模型所需的“原材料”，即成千上万人说出唤醒词的录音。
- **False Acceptance (误触发)**：没人说话但机器自己醒了。
- **False Rejection (拒唤醒)**：你喊它了，但它没理你。
